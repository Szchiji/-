<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bot Admin</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root { --primary-color: #4e73df; --bg-color: #f8f9fc; }
        body { background-color: var(--bg-color); font-family: 'Segoe UI', Roboto, sans-serif; color: #5a5c69; }
        
        /* 侧边栏 */
        .sidebar { width: 250px; background: white; position: fixed; top: 0; left: 0; height: 100vh; border-right: 1px solid #e3e6f0; z-index: 1000; }
        .sidebar-brand { height: 70px; display: flex; align-items: center; padding: 0 1.5rem; font-weight: 800; font-size: 1.2rem; color: #4e73df; border-bottom: 1px solid #e3e6f0; }
        .nav-link { color: #5a5c69; padding: 1rem 1.5rem; font-weight: 600; display: flex; align-items: center; text-decoration: none; transition: 0.2s; }
        .nav-link:hover { background: #f8f9fc; color: #4e73df; }
        .nav-link.active { color: #4e73df; background: #f0f4ff; border-right: 4px solid #4e73df; }
        .nav-link i { width: 24px; margin-right: 8px; text-align: center; }
        
        /* 主内容 */
        .main-wrapper { margin-left: 250px; min-height: 100vh; display: flex; flex-direction: column; }
        .topbar { height: 70px; background: white; border-bottom: 1px solid #e3e6f0; display: flex; align-items: center; justify-content: flex-end; padding: 0 2rem; }
        .content { padding: 2rem; }
        
        /* 全屏布局 */
        .fullscreen-container { width: 100%; min-height: 100vh; display: flex; flex-direction: column; }
        .navbar-simple { height: 70px; background: white; box-shadow: 0 .15rem 1.75rem 0 rgba(58,59,69,.15); padding: 0 2rem; display: flex; align-items: center; justify-content: space-between; }

        @media (max-width: 768px) {
            .sidebar { display: none; }
            .main-wrapper { margin-left: 0; }
        }
    </style>
    {% block head %}{% endblock %}
</head>
<body>

    <!-- 全局气泡提示 -->
    <div class="toast-container position-fixed top-0 end-0 p-3" style="z-index: 1100;">
      <div id="liveToast" class="toast align-items-center border-0 shadow-lg" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="d-flex">
          <div class="toast-body fw-bold" id="toastMessage"></div>
          <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
      </div>
    </div>

    {% block body %}{% endblock %}
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        // 显示气泡
        function showToast(msg, type='success') {
            const el = document.getElementById('liveToast');
            document.getElementById('toastMessage').innerText = msg;
            el.className = `toast align-items-center text-white bg-${type} border-0 shadow-lg`;
            new bootstrap.Toast(el, { delay: 2500 }).show();
        }

        // 通用 API 请求
        async function postApi(url, data) {
            try {
                const r = await fetch(url, {
                    method: 'POST', 
                    headers: {'Content-Type': 'application/json'}, 
                    body: JSON.stringify(data)
                });
                const j = await r.json();
                if(j.status === 'ok') { 
                    showToast(j.msg || '✅ 操作成功', 'success');
                    setTimeout(() => location.reload(), 1000); 
                } else { 
                    showToast(j.msg || '❌ 操作失败', 'danger'); 
                }
            } catch(e) { 
                showToast('❌ 网络错误', 'danger'); 
            }
        }
    </script>
    {% block scripts %}{% endblock %}
</body>
</html>
