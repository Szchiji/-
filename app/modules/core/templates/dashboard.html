{% extends "base.html" %}
{% block content %}
<div class="row mb-4">
    <div class="col-12">
        <div class="card border-0 shadow-sm bg-primary text-white">
            <div class="card-body p-4">
                <h4 class="fw-bold mb-1"><i class="fa-solid fa-server me-2"></i>ç¾¤ç»„ç®¡ç†æ§åˆ¶å°</h4>
                <p class="mb-0 opacity-75">æœºå™¨äººä¼šè‡ªåŠ¨å‘ç°ç¾¤ç»„ã€‚ç‚¹å‡»â€œå¯ç”¨â€å¼€å…³æ¥æ¿€æ´»æœºå™¨äººï¼Œç‚¹å‡»â€œç®¡ç†â€æ¥è®¾ç½®è¯¥ç¾¤çš„ç‹¬ç«‹è§„åˆ™ã€‚</p>
            </div>
        </div>
    </div>
</div>

<div class="card shadow-sm border-0">
    <div class="card-body">
        {% if groups|length == 0 %}
        <div class="text-center py-5 text-muted">
            <i class="fa-solid fa-robot fa-3x mb-3"></i>
            <p>æš‚æ— æ•°æ®ã€‚è¯·å°†æœºå™¨äººæ‹‰å…¥ç¾¤ç»„ï¼Œå¹¶å‘é€ä»»æ„æ¶ˆæ¯æ¥æ¿€æ´»ã€‚</p>
        </div>
        {% else %}
        <div class="table-responsive">
            <table class="table table-hover align-middle">
                <thead class="bg-light">
                    <tr>
                        <th class="ps-4">åç§°</th>
                        <th>ç±»å‹</th>
                        <th>Chat ID</th>
                        <th class="text-center">å¯ç”¨çŠ¶æ€</th>
                        <th class="text-end pe-4">æ“ä½œ</th>
                    </tr>
                </thead>
                <tbody>
                    {% for g in groups %}
                    <tr>
                        <td class="ps-4 fw-bold text-truncate" style="max-width: 200px;">{{ g.title }}</td>
                        <td>
                            {% if g.type == 'supergroup' %}<span class="badge bg-info bg-opacity-10 text-info border">è¶…çº§ç¾¤</span>
                            {% elif g.type == 'channel' %}<span class="badge bg-warning bg-opacity-10 text-warning border">é¢‘é“</span>
                            {% else %}<span class="badge bg-secondary bg-opacity-10 text-secondary border">æ™®é€šç¾¤</span>{% endif %}
                        </td>
                        <td class="font-monospace text-muted small">{{ g.chat_id }}</td>
                        <td class="text-center">
                            <div class="form-check form-switch d-inline-block">
                                <input class="form-check-input" type="checkbox" onchange="toggleGroup({{ g.id }}, this.checked)" {{ 'checked' if g.is_active }}>
                            </div>
                        </td>
                        <td class="text-end pe-4">
                            <!-- ğŸ†• å•ç‹¬ç®¡ç†æŒ‰é’® -->
                            <a href="/core/group/{{ g.id }}" class="btn btn-sm btn-outline-primary fw-bold">
                                <i class="fa-solid fa-gear me-1"></i> ç®¡ç†
                            </a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% endif %}
    </div>
</div>

<script>
    function toggleGroup(id, active) {
        fetch('/core/api/toggle_group', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({id: id, active: active})
        });
    }
</script>
{% endblock %}
